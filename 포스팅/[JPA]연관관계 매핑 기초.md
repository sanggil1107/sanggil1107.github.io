# 연관관계 매핑
 - 방향
    - 단방향, 양방향 존재
    - 방향은 객체관계에만 존재하고 테이블은 항상 양방향
 - 다중성
    - 다대일(N:1), 일대다(1:N), 일대일(1:1), 다대다(N:N) 존재
    - 회원, 팀 관계가 있을때
        - 여러 회원은 한 팀에 속하므로 회원 : 팀 = N : 1
        - 한 팀에 여러 회원이 속하므로 팀 : 회원 = 1: N
 - 연관관계의 주인(owner)
    - 객체를 양방향 관계로 설정하면 연관관계의 주인을 정해야 한다.

## 단방향 연관관계
### 객체 연관관계와 테이블 연관관계의 가장 큰 차이
 - 참조를 통한 연관관계는 언제나 단방향이다. 객체간 연관관계를 양방향으로 만들고 싶으면 반대쪽에도 필드를 추가해서 보관해야 한다. 결국 연관관계가 하나 더 추가되어야 한다. 이것은 양방향 관계가 아니라 서로 다른 단방향 관계 2개인 셈이다. 반면 테이블은 외래키 하나로 양방향으로 조인할 수 있다.

 - 객체 vs 테이블 연관관계
    - 객체는 참조(주소)로 연관관계를 맺는다.
    - 테이블을 외래 키로 연관관계를 맺는다.
    - 참조를 사용하는 객체의 연관관계는 단방향이다.
        - A -> B(a, b)
    - 외래 키를 사용하는 테이블의 연관관계는 양방향이다.
        - A JOIN B, B JOIN A 둘 다 가능

@JoinColumn
@JoinColumn은 외래키를 매핑할 때 사용
|속성|기능|기본값|
|name|매핑할 외래키 이름|필드명 + _ + 참조하는 테이블의 기본키 컬럼명|
|referencedColumnName|외래키가 참조하는 대상 테이블의 컬럼명|참조하는 테이블의 기본키 컬럼명|

@ManyToOne
대다일 관계에서 사용
|속성|기능|기본값|
|optional|false로 설정하면 연관된 엔터티가 항상 있어야한다|true|
|fetch|글로벌 패치전략|EAGER, LAZY|
|cascade|연속성 전이 기능||

## 양방향 연관관계
@OneToMany 매핑 정보에 추가된 mappedBy 속성은 양방향 매핑일때만 사용(반대쪽 매핑의 필드값).

## 연관관계의 주인
객체 연관관계
 - 회원 -> 팀 연관관계 1개(단방향)
 - 팀 -> 회원 연관관계 1개(단방향)

 테이블 연관관계
  - 회원 <-> 팀 연관관계 1개(양방향)

  엔터티를 단방향으로 매핑하면 참조를 하나만 사용하므로 이 참조로 외래키를 관리하면 된다.
  그러나 양방향으로 매핑하면 회원 -> 팀, 팀 -> 회원 두곳에서 서로 참조를 하게 되며 객체의 연관관계를 관리하는 포인트가 2곳으로 늘어나게 된다.
  엔터티를 양방향으로 설정하면 객체의 참조는 2개가 되는데 외래키는 하나이므로 둘 사이에 차이가 발생한다.
  이러한 차이로 인해 JPA에서는 두 객체 연관관계 중 하나를 정해서 테이블의 외래키를 관리하게 되는데 이것을 연관관계의 주인이라고 한다.

  ## 양방향 매핑의 규칙 : 연관관계의 주인
  양방향 매핑 시에는 두 연관관계 중 하나를 연관관계의 주인으로 정해야 한다.
  연관관계 주인만 데이터베이스 연관관계와 매핑되고 외래 키를 관리(등록, 수정, 삭제)할 수 있다. 주인이 아닌 쪽은 읽기만 할 수 있다.
   - 주인은 mappedBy를 사용하지 않는다.
   - 주인이 아니면 mappedBy를 사용하여 주인을 지정해야 한다.
  보통 연관관계의 주인은 외래 키가 있는 곳으로 설정해야 한다. 위의 예에서 외래키 team_id를 가지고 있는 member테이블 즉 Member 엔터티를 주인으로 설정한다.