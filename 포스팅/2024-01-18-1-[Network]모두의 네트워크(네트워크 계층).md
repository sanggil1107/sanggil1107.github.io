## 모두의 네트워크(네트워크 계층)

해당 포스팅은 `모두의 네트워크` 책을 정리한 내용으로 OSI 모델의 2계층인 데이터 링크 계층에 대해 다룬다.

`네트워크 계층(Network Layer)` 은 서로 다른 네트워크에 있는 목적지로 데이터를 전송하는 기능을 수행한다.

<br>

### IP(Internet Protocol)
---

`IP` 란 다른 컴퓨터들이 접근할 수 있게 가지고 있는 고유한 네트워크 주소를 의미한다.

- 네트워크 계층의 대표적인 프로토콜이다.
- 네트워크 계층에서는 상위 계층에서 가져온 데이터를 만들어 IP 헤더를 붙인다.
- IP 프로토콜을 사용하여 캡슐화할 때 이렇게 만들어진 데이터를 IP 패킷이라고 한다.
- 랜 안에서는 MAC 주소만으로도 통신할 수 있지만 네트워크 간에 통신을 하려면 IP 주소가 필요하다.

<br>

#### IP 주소

`IP 주소` 는 실제 주소와 같은 개념으로 다른 네트워크 목적지로 데이터를 보내기 위해 필요하다.

- IP 주소는 인터넷 서비스 제공자(ISP)로부터 받을 수 있다.
- IP 주소 버전으로 IPv4와 IPv6가 있다.
  - IPv4 : 32비트로 이루어져 있다.
  - IPv6 : 128비트로 이루어져 있다.
- IP 주소에는 공인과 사설이 있다.
  - 공인 IP 주소 : 인터넷에 직접 연결되는 컴퓨터나 라우터에 할당된다.
  - 사설 Ip 주소 : 회사나 가정의 랜 컴퓨터에 할당된다.
- DHCP 기능을 이용하여 주소를 자동으로 할당한다.
  - DHCP : Dynamic Host Configuration Protocol의 약어로 IP 주소를 자동으로 할당하는 프로토콜 이다.

<br>

#### IP 주소 클래스

IP 주소는 네트워크의 규모에 따라 A ~ E 클래스로 나뉘어져 있으며 IPv4 32 비트를 톡탯 단위로 끊어 네트워크 ID와 호스트 ID로 구분한다.

- 네트워크 ID는 어떤 네트워크인지, 호스트 ID는 해당 네트워크에서 어떤 컴퓨터인지 나타낸다.

네트워크 ID와 호스트 ID 비중에 따라 네트워크 규모(클래스)를 구분한다.


|클래스 이름|내용|네트워크 ID|호스트 ID|
|---|---|---|---|
|A 클래스|대규모 네트워크 주소|8비트|24비트|
|B 클래스|중형 네트워크 주소|16비트|16비트|
|C 클래스|소규모 네트워크 주소|24비트|8비트|
|D 클래스|멀티캐스트(multicast) 주소|x|x|
|E 클래스|연구 및 특수용도 주소|x|x|

<br>

공인 Ip 주소와 사실 Ip 주소를 포함한 클래스 범위는 다음과 같다.

|클래스 이름|공인 IP 주소의 범위|사설 IP 주소의 범위|
|---|---|---|
|A 클래스|1.0.0.0 ~ 9.255.255.255
11.0.0.0 ~ 126.255.255.255|10.0.0.0 ~ 10.255.255.255|
|B 클래스|128.0.0.0 ~ 172.15.255.255
172.32.0.0 ~ 191.255.255.255|172.16.0.0 ~ 172.31.255.255|
|C 클래스|192.0.0.0 ~ 192.167.255.255
192.169.0.0 ~ 223.255.255.255|192.168.0.0 ~ 192.168.255.255|

- A 클래스의 1옥텟의 범위는 2진수로 00000001~01111111(1~127)
- B 클래스의 1옥텟의 범위는 2진수로 10000000~10111111(128~191)
- C 클래스의 1옥텟의 범위는 2진수로 11000000~11011111(192~223)

<br>

#### 네트워크 주소 / 브로드캐스트 주소

IP 주소에는 특별한 경우에 사용하는 네트워크 주소와 브로드캐스트 주소가 있다. 따라서, 컴퓨터나 라우터가 자신의 IP 주소로 사용할 수 없다.

`네트워크 주소` 는 전체 네트워크에서 작은 네트워크를 대표하는 주소로 네트워크를 식별하기 위해 사용되며 호스트 ID가 10진수로 0이다.
`브로드캐스트 주소` 는 네트워크에 있는 장비 모두에게 한 번에 데이터를 전송하는 데 사용되는 IP 주소이며 호스트 ID가 10진수로 255이다.

<br>

#### 서브넷(Subnet)

A 클래스와 같이 큰 네트워크를 작은 규모의 네트워크로 분할하는 것을 `서브넷팅` 이라고 하며 분할된 네트워크를 `서브넷` 이라고 한다.

기존에 있던 호스트 ID의 일부를 서브넷 ID로 바꾸어 서브넷을 만든다.

- 서브넷팅 전
|네트워크 ID|호스트 ID|
|---|---|
|00000001|00000000 00000000 00000000|

- 서브넷팅 후
|네트워크 ID|서브넷 ID|호스트 ID|
|---|---|---|
|00000001|00000000 00|000000 00000000|


<br>

`서브넷 마스크` 란 네트워크 ID와 호스트 ID를 식별하기 위한 값으로 어디까지가 서브넷 ID인지를 확인하기 위해 사용한다.

서브넷 ID를 사용하지 않은 기존 각 클래스의 서브넷 마스크는 다음과 같다.

|클래스|서브넷 마스크|프리픽스 표기법|
|---|---|---|
|A 클래스|11111111 00000000 00000000 00000000|/8|
|B 클래스|11111111 11111111 00000000 00000000|/16|
|C 클래스|11111111 11111111 11111111 00000000|/24|


<br>

### 라우터(Router)
---

`라우터` 란 서로 다른 네트워크와 통신하기 위해 필요한 장비로 네트워크를 분리하는 역할도 수행한다.

- 다른 네트워크에 있는 컴퓨터에 데이터를 전송하려면 가장 먼저 기본 게이트웨이(default gateway)를 설정해야 한다. 이는 라우터 IP 주소를 설정하는 것이다.
- 라우터 IP 주소가 필요한 이유는 다른 네트워크의 컴퓨터로 데이터를 보내야할 때 송신 컴퓨터는 어디로 보내야할 지 모르기 때문이다.

<br>

#### 라우팅(routing)

`라우팅` 은 경로 정보를 기반으로 현재의 네트워크에서 목적 네트워크까지의 최적의 경로로 데이터를 전송하는 방식이다.

- 경로 정보는 라우터의 라우팅 테이블에 저장되어 있으며 수동으로 등록하거나 자동으로 등록할 수 있다.
  - 수동으로 등록하는 방법은 주로 소규모 네트워크에 적합하다.
  - 자동으로 등록하는 방법은 대규모 네트워크게 적합하며 라우터 간에 경로 정보를 교환하면서 라우팅 테이블 정보를 자동으로 수정한다.

이처럼 라우터 간에 라우팅 정보를 교환하기 위한 프로토콜을 `라우팅 프로토콜` 이라고 하며 대표적으로 RIP, OSPF, BGP 등이 있다.